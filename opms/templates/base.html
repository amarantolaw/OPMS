<!DOCTYPE html>
<html lang="en-gb" >
<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/static/images/favicon.ico" />
    <link rel="shortcut icon" href="/static/images/favicon.ico" />
    <meta name="author" content="University of Oxford" />

    <title>{% block title %}Welcome{% endblock %} :: The OPMS</title>

    <link rel="stylesheet" href="/static/styles/basic.css" media="all" />
    <link rel="stylesheet" href="/static/styles/print.css" media="print" />
    <link rel="stylesheet" href="/static/styles/oxService.css" media="screen,projection" />
    <link rel="stylesheet" href="/static/styles/mainnav.css" media="screen,projection" />
    <link rel="stylesheet" href="/static/styles/lookandfeel.css" media="screen,projection" />
    <link rel="stylesheet" href="/static/styles/layout.css" media="screen,projection" />

    {% block head %}
    <link rel="stylesheet" href="/static/uploadify/uploadify.css" />
    <script src="/static/scripts/jquery-1.6.4.min.js"></script>
    <script src="/static/uploadify/swfobject.js"></script>
    <script src="/static/uploadify/jquery.uploadify.v2.1.4.js"></script>
    <script>
    $(document).ready(function() {
        $('#file_upload').uploadify({
            'uploader'  : '/static/uploadify/uploadify.swf',
            'script'    : '/upload/',
            'cancelImg' : '/static/uploadify/cancel.png',
            'auto'      : false,
            'multi'     : true,
//            'fileExt'   : '*.mp3;*.ogg;*.flac',
            'fileDesc'  : 'Media Files for the Podcasting Team',
            'queueID'   : 'file_upload_queue',
            'displayData' : 'percentage',
            'removeCompleted': false,
            'scriptData': {'description':'No description has been given'},
//            'onError'   : function (event,ID,fileObj,errorObj) {
//                alert(errorObj.type + ' Error: ' + errorObj.info);
//            },
            'onAllComplete' : function(event,data) {
                alert(data.filesUploaded + ' files uploaded successfully!\nThere were ' + data.errors + ' errors.');
            }
        });
    });
    function updateDescription() {
        // Need to remove "&" from strings as jQuery/uploadify throws NPObject errors otherwise. Suspect < and > also
        value = ($('#file_description').val()).replace(/</g,'%3C').replace(/>/g,'%3E').replace(/&/g,'%26');
        $('#file_upload').uploadifySettings('scriptData',{'description':value});
        alert('value=' + value);
    }
    </script>
    {% endblock %}

</head>

<body>
{% block navbar %}
<nav id="mainnav">
    <h2>Main sections</h2>
    <ul class="level-1">
        <li><span class="youarehere">Home</span></li>
        <li><a href="/admin/">Admin</a></li>
        <li><a href="/ffm/">Files &amp; Feeds</a></li>
        <li><a href="/stats/">Statistics</a></li>
    </ul>
</nav>
{% endblock %}

    <div id="content" >
        <div id="breadcrumb"><strong>You are at:</strong> <a href="/">Home</a> {% block breadcrumb %}{% endblock %}</div>
{% block content %}
        <h1>Oxford Podcast Management System (OPMS)</h1>

        <h2>File Upload Form</h2>
        <div id='upload'>
            <p>This short form will allow you to send files directly to the Podcasting Team, and will alert
                them on each file uploaded. Please Click on Select Files, Select up to 20 files, enter some text
                describing those files, click "<a href="javascript:updateDescription();$('#file_upload').uploadifyUpload();">Start
                Upload</a>" and then watch as your files are uploaded.</p>
            <p>Please enter some descriptive text for the files you are about to upload:<br />
                <textarea id="file_description" cols="60" rows="6"></textarea></p>
            <input id="file_upload" type="file" name="Filedata" />
            <p>Upload Queue:
                <div id='file_upload_queue'></div>
            </p>
            <p><a href="javascript:$('#file_upload').uploadifyUpload();">Start Upload</a> :
                <a href="javascript:updateDescription();jQuery('#file_upload').uploadifyClearQueue()">Cancel All Uploads</a></p>
        </div>
{% endblock %}
    <!-- div.content closes -->
    </div>

    <footer id="footer" >
        <div id="site-info"  >
            <h2   class="nonvis-exposition">Site Information</h2>
			<dl>
				<dt class="nonvis-exposition">Institution</dt><dd id="institution"><a id="oxcrest"  href="http://www.ox.ac.uk/">University of Oxford</a></dd>
				<dt class="nonvis-exposition">Service</dt><dd id="serviceName" >OPMS - Oxford Podcast Management System</dd>
			</dl>
		<!-- div#site-info closes -->
		</div>
	<!-- div#footer closes -->
	</footer>
</body>
</html>
