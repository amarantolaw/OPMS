{% load static %}
{% get_static_prefix as STATIC_PREFIX %}
{% extends "stats/base.html" %}
{% block head %}
    <script src="{{ STATIC_PREFIX }}scripts/jquery-1.6.4.min.js"></script>
    <script src="{{ STATIC_PREFIX }}scripts/jquery.tablesorter.min.js"></script>
{% endblock %}

{% block title %}Summary Feed Data ({{ref}}) from Apple iTU Reporting{% endblock %}

{% block navbar %}
<div id="mainnav">
    <h2>Main sections</h2>
    <ul class="level-1">
        <li><a href="/">Home</a></li>
        <li><a href="/admin/">Admin</a></li>
        <li><a href="/ffm/">Files &amp; Feeds</a></li>
        <li><a href="/stats/" class="currentsection">Statistics</a></li>
    </ul>
</div>
<div id="mainnav2">
    <h3>Sub sections for Statistics</h3>
    <ul class="level-2">
        <li><a href="/stats/report/urlmonitoring/">URL Monitoring</a></li>
        <li><a href="/stats/report/summary/">Summary</a></li>
        <li><a href="/stats/report/summary/feeds/" class="selected">Feeds</a></li>
    </ul>
</div>
{% endblock %}

{% block breadcrumb %}&gt; <a href="/stats/report/summary/feeds/">Apple Feeds</a> &gt; Feed Detail{% endblock %}


{% block content %}
<h1>Summary for {{ref}} (psudeo feed)</h1>

{% if listing %}

{% if summary %}
<h3>Summary</h3>
<p>This feed has {{ summary.count }} items and in total they have been downloaded {{ summary.total }} times, making the average per item of {{ summary.avg }} downloads.<br />
Most popular {{summary.max_term|default:"item"}} ({{ summary.max_name }}) had {{ summary.max_value }} downloads.</p>
{% endif %}

<h3>Data visualisation</h3>

<p><img src="/stats/graph/apple/feed_by_week/{{ref}}.png" /><br />
    <a href="/stats/graph/apple/feed_by_week/{{ref}}.png?dpi=300">[Print Version]</a> <a href="/stats/graph/apple/feed_by_week/{{ref}}.png?dpi=600">[High Resolution]</a></p>

<script>
$(document).ready(function()
    {
        $("#summaryTable").tablesorter( {sortList: [[0,1]]} );
    }
);
</script>

<h3>Data table</h3>
<p>Display with columns of: <a href="?orientation=0">Items</a> or <a href="?orientation=1">Weeks</a></p>
<table id="summaryTable" class="tablesorter">
    <thead>
        {% for row in listing %}
        {% if forloop.counter0 == 0 %}
        <tr>
            <th>{{ row.column_a|default:"Week Commencing" }}</th>
            <th>{{ row.total|default:"Week Total" }}</th>
            {% for item in row.data %}
            <th>{{ item }}</th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% endif %}
        {% if forloop.counter0 == 1 %}
        <tr>
            <td>{{ row.column_a }}</td>
            <td>{{ row.total }}</td>
            {% for item in row.data %}
            <td class="highlight-total">{{ item }}</td>
            {% endfor %}
        </tr>
        {% endif %}
        {% if forloop.counter0 > 1 %}
        <tr>
            <td>{{ row.column_a }}</td>
            <td class="highlight-total">{{ row.total }}</td>
            {% for item in row.data %}
            <td>{{ item }}</td>
            {% endfor %}
        </tr>
        {% endif %}
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>Data is missing</p>
{% endif %}


{% endblock %}